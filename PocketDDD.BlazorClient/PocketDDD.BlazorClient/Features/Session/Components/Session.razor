@page "/session/{id:int}"

@inherits Fluxor.Blazor.Web.Components.FluxorComponent

@using PocketDDD.BlazorClient.Features.Session.Store

@inject IState<SessionState> State
@inject IDispatcher Dispatcher
@inject NavigationManager Navigation

<MudLayout>
    <MudAppBar>
        <MudIconButton 
            Icon="@Icons.Material.Filled.ArrowBack"
            OnClick="NavigateHome" />
        <MudSpacer />
        <h3>@State.Value.Session?.Title</h3>
    </MudAppBar>
    <MudMainContent>
        @if (State.Value.Session is not null)
        {
            <p>@State.Value.Session.Detail</p>
        }
    </MudMainContent>
</MudLayout>

@code {
    [Parameter]
    public int Id { get; set; }

    protected override void OnInitialized()
    {
        if (State.Value.Session is null)
            Dispatcher.Dispatch(new ViewSessionAction(Id));

        base.OnInitialized();
    }

    void NavigateHome() => Navigation.NavigateTo("/");
}
